'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var paths = require('../lib/paths.cjs.js');
var eslint = require('eslint');

var lint = async (directories, opts) => {
  const eslint$1 = new eslint.ESLint({
    cwd: paths.paths.targetDir,
    fix: opts.fix,
    extensions: ["js", "jsx", "ts", "tsx", "mjs", "cjs"]
  });
  const results = await eslint$1.lintFiles(
    directories.length ? directories : ["."]
  );
  const maxWarnings = opts.maxWarnings ?? 0;
  const failed = results.some((r) => r.errorCount > 0) || results.reduce((current, next) => current + next.warningCount, 0) > maxWarnings;
  if (opts.fix) {
    await eslint.ESLint.outputFixes(results);
  }
  const formatter = await eslint$1.loadFormatter(opts.format);
  if (opts.format === "eslint-formatter-friendly") {
    process.chdir(paths.paths.targetRoot);
  }
  const resultText = formatter.format(results);
  if (resultText) {
    console.log(resultText);
  }
  if (failed) {
    process.exit(1);
  }
};

exports.default = lint;
//# sourceMappingURL=lint.cjs.js.map
